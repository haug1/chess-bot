var Et=Object.defineProperty;var Tt=(y,w,M)=>w in y?Et(y,w,{enumerable:!0,configurable:!0,writable:!0,value:M}):y[w]=M;var C=(y,w,M)=>(Tt(y,typeof w!="symbol"?w+"":w,M),M);(function(){"use strict";function y(){}function w(e){return e()}function M(){return Object.create(null)}function P(e){e.forEach(w)}function We(e){return typeof e=="function"}function W(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function qe(e){return Object.keys(e).length===0}function ke(e,...t){if(e==null)return y;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function E(e,t,n){e.$$.on_destroy.push(ke(t,n))}function de(e){return e==null?"":e}function x(e,t){e.appendChild(t)}function v(e,t,n){e.insertBefore(t,n||null)}function p(e){e.parentNode.removeChild(e)}function z(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function B(e){return document.createElement(e)}function He(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function J(e){return document.createTextNode(e)}function A(){return J(" ")}function me(){return J("")}function Pe(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Be(e){return Array.from(e.childNodes)}function _e(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}let re;function L(e){re=e}const j=[],ye=[],U=[],be=[],Le=Promise.resolve();let se=!1;function je(){se||(se=!0,Le.then(pe))}function ie(e){U.push(e)}const le=new Set;let V=0;function pe(){const e=re;do{for(;V<j.length;){const t=j[V];V++,L(t),Ke(t.$$)}for(L(null),j.length=0,V=0;ye.length;)ye.pop()();for(let t=0;t<U.length;t+=1){const n=U[t];le.has(n)||(le.add(n),n())}U.length=0}while(j.length);for(;be.length;)be.pop()();se=!1,le.clear(),L(e)}function Ke(e){if(e.fragment!==null){e.update(),P(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ie)}}const Q=new Set;let F;function Z(){F={r:0,c:[],p:F}}function X(){F.r||P(F.c),F=F.p}function d(e,t){e&&e.i&&(Q.delete(e),e.i(t))}function b(e,t,n,o){if(e&&e.o){if(Q.has(e))return;Q.add(e),F.c.push(()=>{Q.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function R(e){e&&e.c()}function T(e,t,n,o){const{fragment:i,on_mount:r,on_destroy:l,after_update:a}=e.$$;i&&i.m(t,n),o||ie(()=>{const s=r.map(w).filter(We);l?l.push(...s):P(s),e.$$.on_mount=[]}),a.forEach(ie)}function I(e,t){const n=e.$$;n.fragment!==null&&(P(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function De(e,t){e.$$.dirty[0]===-1&&(j.push(e),je(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function K(e,t,n,o,i,r,l,a=[-1]){const s=re;L(e);const h=e.$$={fragment:null,ctx:null,props:r,update:y,not_equal:i,bound:M(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(s?s.$$.context:[])),callbacks:M(),dirty:a,skip_bound:!1,root:t.target||s.$$.root};l&&l(h.root);let c=!1;if(h.ctx=n?n(e,t.props||{},(f,u,...g)=>{const O=g.length?g[0]:u;return h.ctx&&i(h.ctx[f],h.ctx[f]=O)&&(!h.skip_bound&&h.bound[f]&&h.bound[f](O),c&&De(e,f)),u}):[],h.update(),c=!0,P(h.before_update),h.fragment=o?o(h.ctx):!1,t.target){if(t.hydrate){const f=Be(t.target);h.fragment&&h.fragment.l(f),f.forEach(p)}else h.fragment&&h.fragment.c();t.intro&&d(e.$$.fragment),T(e,t.target,t.anchor,t.customElement),pe()}L(s)}class D{$destroy(){I(this,1),this.$destroy=y}$on(t,n){const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!qe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Ye(e){let t;return{c(){t=He("circle"),m(t,"cx",e[1]),m(t,"cy",e[2]),m(t,"stroke",e[0]),m(t,"opacity","1"),m(t,"r","0.4"),m(t,"stroke-width","0.1"),m(t,"fill","none")},m(n,o){v(n,t,o)},p(n,[o]){o&2&&m(t,"cx",n[1]),o&4&&m(t,"cy",n[2]),o&1&&m(t,"stroke",n[0])},i:y,o:y,d(n){n&&p(t)}}}function ze(e,t,n){let{color:o}=t,{x:i=0}=t,{y:r=0}=t;return e.$$set=l=>{"color"in l&&n(0,o=l.color),"x"in l&&n(1,i=l.x),"y"in l&&n(2,r=l.y)},[o,i,r]}class ee extends D{constructor(t){super(),K(this,t,ze,Ye,W,{color:0,x:1,y:2})}}const q=[];function Y(e,t=y){let n;const o=new Set;function i(a){if(W(e,a)&&(e=a,n)){const s=!q.length;for(const h of o)h[1](),q.push(h,e);if(s){for(let h=0;h<q.length;h+=2)q[h][0](q[h+1]);q.length=0}}}function r(a){i(a(e))}function l(a,s=y){const h=[a,s];return o.add(h),o.size===1&&(n=t(i)||y),a(e),()=>{o.delete(h),o.size===0&&(n(),n=null)}}return{set:i,update:r,subscribe:l}}var _=(e=>(e[e.ERROR=0]="ERROR",e[e.ABORTED=1]="ABORTED",e[e.WAITING_FOR_GAME=2]="WAITING_FOR_GAME",e[e.WAITING_FOR_OPPONENT=3]="WAITING_FOR_OPPONENT",e[e.WAITING_FOR_STOCKFISH=4]="WAITING_FOR_STOCKFISH",e[e.WAITING_FOR_PLAYER=5]="WAITING_FOR_PLAYER",e))(_||{});const ve=Y(""),k=Y([]),H=Y([]),we=Y(""),G=Y(2);function $(e,t){switch(e){case 0:return t===_.WAITING_FOR_STOCKFISH?"rgba(255,255,0,1)":"rgba(0,255,0,1)";case 1:return t===_.WAITING_FOR_STOCKFISH?"rgba(255,255,0,0.5)":"rgba(0,255,0,0.5)";case 2:default:return t===_.WAITING_FOR_STOCKFISH?"rgba(255,255,0,0.3)":"rgba(0,255,0,0.3)"}}function N(e,t){switch(e){case 0:return"rgba(255,0,0,1)";case 1:return"rgba(255,0,0,0.5)";case 2:default:return"rgba(255,0,0,0.3)"}}function Oe(e,t,n){const o=e.slice();return o[5]=t[n],o[7]=n,o}function Ee(e,t,n){const o=e.slice();return o[5]=t[n],o[7]=n,o}function Te(e){let t,n,o,i;return t=new ee({props:{color:$(e[7],e[2]),x:e[5].from.x,y:e[5].from.y}}),o=new ee({props:{color:$(e[7],e[2]),x:e[5].to.x,y:e[5].to.y}}),{c(){R(t.$$.fragment),n=A(),R(o.$$.fragment)},m(r,l){T(t,r,l),v(r,n,l),T(o,r,l),i=!0},p(r,l){const a={};l&4&&(a.color=$(r[7],r[2])),l&2&&(a.x=r[5].from.x),l&2&&(a.y=r[5].from.y),t.$set(a);const s={};l&4&&(s.color=$(r[7],r[2])),l&2&&(s.x=r[5].to.x),l&2&&(s.y=r[5].to.y),o.$set(s)},i(r){i||(d(t.$$.fragment,r),d(o.$$.fragment,r),i=!0)},o(r){b(t.$$.fragment,r),b(o.$$.fragment,r),i=!1},d(r){I(t,r),r&&p(n),I(o,r)}}}function Ie(e){let t,n,o,i;return t=new ee({props:{color:N(e[7],e[2]),x:e[5].from.x,y:e[5].from.y}}),o=new ee({props:{color:N(e[7],e[2]),x:e[5].to.x,y:e[5].to.y}}),{c(){R(t.$$.fragment),n=A(),R(o.$$.fragment)},m(r,l){T(t,r,l),v(r,n,l),T(o,r,l),i=!0},p(r,l){const a={};l&4&&(a.color=N(r[7],r[2])),l&1&&(a.x=r[5].from.x),l&1&&(a.y=r[5].from.y),t.$set(a);const s={};l&4&&(s.color=N(r[7],r[2])),l&1&&(s.x=r[5].to.x),l&1&&(s.y=r[5].to.y),o.$set(s)},i(r){i||(d(t.$$.fragment,r),d(o.$$.fragment,r),i=!0)},o(r){b(t.$$.fragment,r),b(o.$$.fragment,r),i=!1},d(r){I(t,r),r&&p(n),I(o,r)}}}function Je(e){let t,n,o,i=e[1],r=[];for(let c=0;c<i.length;c+=1)r[c]=Te(Ee(e,i,c));const l=c=>b(r[c],1,1,()=>{r[c]=null});let a=e[0],s=[];for(let c=0;c<a.length;c+=1)s[c]=Ie(Oe(e,a,c));const h=c=>b(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<r.length;c+=1)r[c].c();t=A();for(let c=0;c<s.length;c+=1)s[c].c();n=me()},m(c,f){for(let u=0;u<r.length;u+=1)r[u].m(c,f);v(c,t,f);for(let u=0;u<s.length;u+=1)s[u].m(c,f);v(c,n,f),o=!0},p(c,[f]){if(f&6){i=c[1];let u;for(u=0;u<i.length;u+=1){const g=Ee(c,i,u);r[u]?(r[u].p(g,f),d(r[u],1)):(r[u]=Te(g),r[u].c(),d(r[u],1),r[u].m(t.parentNode,t))}for(Z(),u=i.length;u<r.length;u+=1)l(u);X()}if(f&5){a=c[0];let u;for(u=0;u<a.length;u+=1){const g=Oe(c,a,u);s[u]?(s[u].p(g,f),d(s[u],1)):(s[u]=Ie(g),s[u].c(),d(s[u],1),s[u].m(n.parentNode,n))}for(Z(),u=a.length;u<s.length;u+=1)h(u);X()}},i(c){if(!o){for(let f=0;f<i.length;f+=1)d(r[f]);for(let f=0;f<a.length;f+=1)d(s[f]);o=!0}},o(c){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)b(r[f]);s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)b(s[f]);o=!1},d(c){z(r,c),c&&p(t),z(s,c),c&&p(n)}}}function te(e,t,n=!1){const o=parseInt(e.toString());let i;return t?i=n?3.5-o+1:-3.5+o-1:i=n?-3.5+o-1:3.5-o+1,i.toString()}function Ce(e){const t=document.querySelector("coords.files").classList.contains("black");return{from:{x:te(e.from.x,t,!0),y:te(e.from.y,t)},to:{x:te(e.to.x,t,!0),y:te(e.to.y,t)}}}function Ue(e,t,n){let o,i,r,l,a;return E(e,H,s=>n(3,r=s)),E(e,k,s=>n(4,l=s)),E(e,G,s=>n(2,a=s)),e.$$.update=()=>{e.$$.dirty&16&&n(1,o=l.map(s=>Ce(s))),e.$$.dirty&8&&n(0,i=r.map(s=>Ce(s)))},[i,o,a,r,l]}class Ve extends D{constructor(t){super(),K(this,t,Ue,Je,W,{})}}async function Qe(e,t){const n=e.getReader();let o;for(;!(o=await n.read()).done;)t(o.value)}function Ze(e){let t,n,o,i=!1;return function(l){t===void 0?(t=l,n=0,o=-1):t=et(t,l);const a=t.length;let s=0;for(;n<a;){i&&(t[n]===10&&(s=++n),i=!1);let h=-1;for(;n<a&&h===-1;++n)switch(t[n]){case 58:o===-1&&(o=n-s);break;case 13:i=!0;case 10:h=n;break}if(h===-1)break;e(t.subarray(s,h),o),s=n,o=-1}s===a?t=void 0:s!==0&&(t=t.subarray(s),n-=s)}}function Xe(e,t,n){let o=Me();const i=new TextDecoder;return function(l,a){if(l.length===0)n==null||n(o),o=Me();else if(a>0){const s=i.decode(l.subarray(0,a)),h=a+(l[a+1]===32?2:1),c=i.decode(l.subarray(h));switch(s){case"data":o.data=o.data?o.data+`
`+c:c;break;case"event":o.event=c;break;case"id":e(o.id=c);break;case"retry":const f=parseInt(c,10);isNaN(f)||t(o.retry=f);break}}}}function et(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Me(){return{data:"",event:"",id:"",retry:void 0}}var tt=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};const ce="text/event-stream",nt=1e3,Ae="last-event-id";function ot(e,t){var{signal:n,headers:o,onopen:i,onmessage:r,onclose:l,onerror:a,openWhenHidden:s,fetch:h}=t,c=tt(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((f,u)=>{const g=Object.assign({},o);g.accept||(g.accept=ce);let O;function Fe(){O.abort(),document.hidden||he()}s||document.addEventListener("visibilitychange",Fe);let Ge=nt,ae=0;function fe(){document.removeEventListener("visibilitychange",Fe),window.clearTimeout(ae),O.abort()}n==null||n.addEventListener("abort",()=>{fe(),u({aborted:!0})});const wt=h!=null?h:window.fetch,Ot=i!=null?i:rt;async function he(){var ge;O=new AbortController;try{const oe=await wt(e,Object.assign(Object.assign({},c),{headers:g,signal:O.signal}));await Ot(oe),await Qe(oe.body,Ze(Xe(S=>{S?g[Ae]=S:delete g[Ae]},S=>{Ge=S},r))),l==null||l(),fe(),f()}catch(oe){if(!O.signal.aborted)try{const S=(ge=a==null?void 0:a(oe))!==null&&ge!==void 0?ge:Ge;window.clearTimeout(ae),ae=window.setTimeout(he,S)}catch(S){fe(),u(S)}}}he()})}function rt(e){const t=e.headers.get("content-type");if(!(t!=null&&t.startsWith(ce)))throw new Error(`Expected content-type to be ${ce}, Actual: ${t}`)}class st{constructor(){C(this,"abortController")}abort(){this.abortController!==void 0&&!this.abortController.signal.aborted&&this.abortController.abort(),this.abortController=void 0}getEvaluation(t,n,o){this.abortController=new AbortController;const i=this.abortController.signal;return new Promise(async(r,l)=>{try{await ot("http://localhost:8080/moves/sse",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({moves:t}),signal:i,onmessage(a){const s=JSON.parse(a.data);o({...s,refMoveCounter:n})},onclose(){i.aborted&&l({aborted:!0}),r()},onerror(a){l(a)}})}catch(a){l(a)}})}async getBestMoveBasedOnFEN(t,n){this.abortController=new AbortController;try{return{...await(await fetch("http://localhost:8080/moves",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({moves:t}),signal:this.abortController.signal})).json(),refMoveCounter:n}}catch(o){throw o.name==="AbortError"?{aborted:!0}:o}finally{this.abortController=void 0}}}const It="";function it(e){let t,n,o,i,r,l,a,s,h,c;return{c(){t=B("div"),n=B("span"),o=J(e[2]),i=A(),r=B("span"),l=J(e[0]),a=A(),s=B("button"),s.textContent="Refresh",m(n,"class","svelte-sxmbib"),m(r,"class","svelte-sxmbib"),m(s,"class","svelte-sxmbib"),m(t,"style",e[1]),m(t,"class","svelte-sxmbib")},m(f,u){v(f,t,u),x(t,n),x(n,o),x(t,i),x(t,r),x(r,l),x(t,a),x(t,s),h||(c=Pe(s,"click",e[3]),h=!0)},p(f,[u]){u&4&&_e(o,f[2]),u&1&&_e(l,f[0]),u&2&&m(t,"style",f[1])},i:y,o:y,d(f){f&&p(t),h=!1,c()}}}function lt(e,t,n){let o,i,r,l,a,s;E(e,we,g=>n(5,l=g)),E(e,G,g=>n(6,a=g)),E(e,ve,g=>n(2,s=g));function h(g){switch(g){case _.ERROR:case _.WAITING_FOR_PLAYER:return"4px";default:return"2px"}}function c(g){switch(g){case _.ERROR:return"red";case _.ABORTED:return"orange";case _.WAITING_FOR_STOCKFISH:return"yellow";case _.WAITING_FOR_PLAYER:return"green";default:return"black"}}function f(g,O){switch(g){case _.ERROR:return"ERROR";case _.ABORTED:return"ABORTED";case _.WAITING_FOR_OPPONENT:return"Waiting for opponent..";case _.WAITING_FOR_STOCKFISH:case _.WAITING_FOR_PLAYER:return O;default:return""}}function u(){ue.resync()}return e.$$.update=()=>{e.$$.dirty&64&&n(4,o={"border-width":h(a),"border-color":c(a)}),e.$$.dirty&16&&n(1,i=Object.keys(o).map(g=>`--${g}:${o[g]}`).join(";")),e.$$.dirty&96&&n(0,r=f(a,l))},[r,i,s,u,o,l,a]}class ct extends D{constructor(t){super(),K(this,t,lt,it,W,{})}}const ut=(e,t)=>e.from.x!==t.from.x||e.from.y!==t.from.y||e.to.x!==t.to.x||e.to.y!==t.to.y,at=(e,t)=>e.from.x===t.from.x&&e.from.y===t.from.y&&e.to.x===t.to.x&&e.to.y===t.to.y;class Re{constructor(){C(this,"_stockfish",new st);C(this,"moveCounter",0);C(this,"moveObserver");C(this,"friendlyMoves");C(this,"enemyMoves");k.subscribe(t=>this.friendlyMoves=t),H.subscribe(t=>this.enemyMoves=t)}mount(){new Promise(()=>new this.Highlights({target:this.highlightsTarget})),new Promise(()=>new ct({target:this.statusTarget})),this.onMoveObserved(),this.startObservingMoves()}resync(){this.moveCounter=0,this.moveObserver&&(this.moveObserver.disconnect(),this.moveObserver=void 0),this.onMoveObserved(),this.startObservingMoves()}async onMoveObserved(){++this.moveCounter;try{k.set([]),H.set([]),this._stockfish.abort(),await this.handleTurn(this.moveCounter%2!==0)}catch(t){throw G.set(_.ERROR),t}}startObservingMoves(){this.moveObserver=new MutationObserver(()=>{this.onMoveObserved()}),this.moveObserver.observe(this.movesContainer,{childList:!0,subtree:!0})}addTopMove(t,n,o){t.set([n,...o.filter(ft(n)).slice(0,1)])}async handleTurn(t){G.set(_.WAITING_FOR_STOCKFISH);try{await this._stockfish.getEvaluation(this.scrapeMoves(),this.moveCounter,n=>{const o=this.moveCounter!==n.refMoveCounter;if(o)throw{stale:o};if(we.set(n.raw),n.bestmove){const i=t?n.bestmove.bestmove:n.bestmove.ponder,r=t?n.bestmove.ponder:n.bestmove.bestmove;i&&this.addTopMove(k,i,this.friendlyMoves),r&&this.addTopMove(H,r,this.enemyMoves)}if(n.evaluation){const i=t?n.evaluation.friendly:n.evaluation.enemy,r=t?n.evaluation.enemy:n.evaluation.friendly;i&&this.addTopMove(k,i,this.friendlyMoves),r&&this.addTopMove(H,r,this.enemyMoves)}n.score&&ve.set(n.score)}),t?G.set(_.WAITING_FOR_PLAYER):G.set(_.WAITING_FOR_OPPONENT)}catch(n){if(!(n.stale||n.aborted))throw n}}}function ft(e){return(t,n,o)=>{const i=ut(t,e),l=o.findIndex(a=>at(t,a))===n;return i&&l}}function ht(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("class","cg-shapes"),e.setAttribute("viewBox","-4 -4 8 8"),e.setAttribute("preserveAspectRatio","xMidYMid slice"),e}class gt extends Re{constructor(){super(...arguments);C(this,"Highlights",Ve)}get highlightsTarget(){const n=document.querySelector("cg-container");if(!n)throw new Error("Highlights target not found");const o=ht();return n.appendChild(o),o}get movesContainer(){const n=document.querySelector("rm6");if(!n)throw new Error("Moves container not found");return n}get statusTarget(){const n=document.querySelector(".round__app.variant-standard");if(!n)throw new Error("Status target not found");return n}isGame(){var i;const n=document.querySelector(".message > div:nth-child(1)"),o=n&&((i=n.textContent)==null?void 0:i.includes("It's your turn!"))||!1;return!!document.querySelector("l4x")||o}scrapeMoves(){let n=[];for(const o of document.querySelectorAll("l4x u8t"))o.textContent&&n.push(o.textContent);return n}}const Ct="";function dt(e){let t,n;return{c(){t=B("div"),m(t,"class",n=de(e[0])+" svelte-15mzqdd"),m(t,"style",e[1])},m(o,i){v(o,t,i)},p(o,[i]){i&1&&n!==(n=de(o[0])+" svelte-15mzqdd")&&m(t,"class",n),i&2&&m(t,"style",o[1])},i:y,o:y,d(o){o&&p(t)}}}function mt(e,t,n){let o,i,{color:r}=t,{x:l,y:a}=t;return e.$$set=s=>{"color"in s&&n(2,r=s.color),"x"in s&&n(3,l=s.x),"y"in s&&n(4,a=s.y)},e.$$.update=()=>{e.$$.dirty&4&&n(1,o=`--highlight-color:${r};`),e.$$.dirty&24&&n(0,i=`highlight square-${l}${a}`)},[i,o,r,l,a]}class ne extends D{constructor(t){super(),K(this,t,mt,dt,W,{color:2,x:3,y:4})}}function $e(e,t,n){const o=e.slice();return o[3]=t[n],o[5]=n,o}function Ne(e,t,n){const o=e.slice();return o[6]=t[n],o[5]=n,o}function Se(e){let t,n,o,i;return t=new ne({props:{color:$(e[5],e[1]),x:e[6].from.x,y:e[6].from.y}}),o=new ne({props:{color:$(e[5],e[1]),x:e[6].to.x,y:e[6].to.y}}),{c(){R(t.$$.fragment),n=A(),R(o.$$.fragment)},m(r,l){T(t,r,l),v(r,n,l),T(o,r,l),i=!0},p(r,l){const a={};l&2&&(a.color=$(r[5],r[1])),l&1&&(a.x=r[6].from.x),l&1&&(a.y=r[6].from.y),t.$set(a);const s={};l&2&&(s.color=$(r[5],r[1])),l&1&&(s.x=r[6].to.x),l&1&&(s.y=r[6].to.y),o.$set(s)},i(r){i||(d(t.$$.fragment,r),d(o.$$.fragment,r),i=!0)},o(r){b(t.$$.fragment,r),b(o.$$.fragment,r),i=!1},d(r){I(t,r),r&&p(n),I(o,r)}}}function xe(e){let t,n,o,i;return t=new ne({props:{color:N(e[5],e[1]),x:e[3].from.x,y:e[3].from.y}}),o=new ne({props:{color:N(e[5],e[1]),x:e[3].to.x,y:e[3].to.y}}),{c(){R(t.$$.fragment),n=A(),R(o.$$.fragment)},m(r,l){T(t,r,l),v(r,n,l),T(o,r,l),i=!0},p(r,l){const a={};l&2&&(a.color=N(r[5],r[1])),l&4&&(a.x=r[3].from.x),l&4&&(a.y=r[3].from.y),t.$set(a);const s={};l&2&&(s.color=N(r[5],r[1])),l&4&&(s.x=r[3].to.x),l&4&&(s.y=r[3].to.y),o.$set(s)},i(r){i||(d(t.$$.fragment,r),d(o.$$.fragment,r),i=!0)},o(r){b(t.$$.fragment,r),b(o.$$.fragment,r),i=!1},d(r){I(t,r),r&&p(n),I(o,r)}}}function _t(e){let t,n,o,i=e[0],r=[];for(let c=0;c<i.length;c+=1)r[c]=Se(Ne(e,i,c));const l=c=>b(r[c],1,1,()=>{r[c]=null});let a=e[2],s=[];for(let c=0;c<a.length;c+=1)s[c]=xe($e(e,a,c));const h=c=>b(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<r.length;c+=1)r[c].c();t=A();for(let c=0;c<s.length;c+=1)s[c].c();n=me()},m(c,f){for(let u=0;u<r.length;u+=1)r[u].m(c,f);v(c,t,f);for(let u=0;u<s.length;u+=1)s[u].m(c,f);v(c,n,f),o=!0},p(c,[f]){if(f&3){i=c[0];let u;for(u=0;u<i.length;u+=1){const g=Ne(c,i,u);r[u]?(r[u].p(g,f),d(r[u],1)):(r[u]=Se(g),r[u].c(),d(r[u],1),r[u].m(t.parentNode,t))}for(Z(),u=i.length;u<r.length;u+=1)l(u);X()}if(f&6){a=c[2];let u;for(u=0;u<a.length;u+=1){const g=$e(c,a,u);s[u]?(s[u].p(g,f),d(s[u],1)):(s[u]=xe(g),s[u].c(),d(s[u],1),s[u].m(n.parentNode,n))}for(Z(),u=a.length;u<s.length;u+=1)h(u);X()}},i(c){if(!o){for(let f=0;f<i.length;f+=1)d(r[f]);for(let f=0;f<a.length;f+=1)d(s[f]);o=!0}},o(c){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)b(r[f]);s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)b(s[f]);o=!1},d(c){z(r,c),c&&p(t),z(s,c),c&&p(n)}}}function yt(e,t,n){let o,i,r;return E(e,k,l=>n(0,o=l)),E(e,G,l=>n(1,i=l)),E(e,H,l=>n(2,r=l)),[o,i,r]}class bt extends D{constructor(t){super(),K(this,t,yt,_t,W,{})}}class pt extends Re{constructor(){super(...arguments);C(this,"Highlights",bt)}get highlightsTarget(){const n=document.querySelector("chess-board");if(!n)throw new Error("Highlights target not found");return n}get movesContainer(){const n=document.querySelector("vertical-move-list");if(!n)throw new Error("Moves container not found");return n}get statusTarget(){const n=document.querySelector(".play-controller-message");if(!n)throw new Error("Status target not found");const o=document.createElement("div");return n.insertBefore(o,n.firstChild),o}isGame(){return!!document.querySelector("vertical-move-list")}scrapeMoves(){let n=[];for(const o of document.querySelectorAll(".move .node"))o.textContent&&n.push(o.textContent);return n}}const ue=window.location.host==="lichess.org"?new gt:new pt,vt=setInterval(()=>{ue.isGame()&&(clearInterval(vt),ue.mount())},1e3)})();
