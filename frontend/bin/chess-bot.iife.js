var qt=Object.defineProperty;var Ft=(P,W,G)=>W in P?qt(P,W,{enumerable:!0,configurable:!0,writable:!0,value:G}):P[W]=G;var Y=(P,W,G)=>(Ft(P,typeof W!="symbol"?W+"":W,G),G);(function(){"use strict";function P(){}function W(e){return e()}function G(){return Object.create(null)}function se(e){e.forEach(W)}function it(e){return typeof e=="function"}function X(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}function st(e){return Object.keys(e).length===0}function rt(e,...n){if(e==null)return P;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}function H(e,n,s){e.$$.on_destroy.push(rt(n,s))}function Me(e){return e==null?"":e}function ot(e,n,s){return e.set(s),n}function Te(e,n){e.appendChild(n)}function B(e,n,s){e.insertBefore(n,s||null)}function $(e){e.parentNode.removeChild(e)}function he(e){return document.createElement(e)}function lt(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Ie(e){return document.createTextNode(e)}function re(){return Ie(" ")}function qe(){return Ie("")}function ft(e,n,s,i){return e.addEventListener(n,s,i),()=>e.removeEventListener(n,s,i)}function N(e,n,s){s==null?e.removeAttribute(n):e.getAttribute(n)!==s&&e.setAttribute(n,s)}function ct(e){return Array.from(e.childNodes)}function ut(e,n){n=""+n,e.wholeText!==n&&(e.data=n)}let Ne;function oe(e){Ne=e}const le=[],Fe=[],_e=[],$e=[],at=Promise.resolve();let ke=!1;function ht(){ke||(ke=!0,at.then(We))}function Oe(e){_e.push(e)}const Re=new Set;let de=0;function We(){const e=Ne;do{for(;de<le.length;){const n=le[de];de++,oe(n),_t(n.$$)}for(oe(null),le.length=0,de=0;Fe.length;)Fe.pop()();for(let n=0;n<_e.length;n+=1){const s=_e[n];Re.has(s)||(Re.add(s),s())}_e.length=0}while(le.length);for(;$e.length;)$e.pop()();ke=!1,Re.clear(),oe(e)}function _t(e){if(e.fragment!==null){e.update(),se(e.before_update);const n=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,n),e.after_update.forEach(Oe)}}const ge=new Set;let z;function me(){z={r:0,c:[],p:z}}function pe(){z.r||se(z.c),z=z.p}function k(e,n){e&&e.i&&(ge.delete(e),e.i(n))}function M(e,n,s,i){if(e&&e.o){if(ge.has(e))return;ge.add(e),z.c.push(()=>{ge.delete(e),i&&(s&&e.d(1),i())}),e.o(n)}else i&&i()}function x(e){e&&e.c()}function Z(e,n,s,i){const{fragment:r,on_mount:f,on_destroy:u,after_update:h}=e.$$;r&&r.m(n,s),i||Oe(()=>{const y=f.map(W).filter(it);u?u.push(...y):se(y),e.$$.on_mount=[]}),h.forEach(Oe)}function J(e,n){const s=e.$$;s.fragment!==null&&(se(s.on_destroy),s.fragment&&s.fragment.d(n),s.on_destroy=s.fragment=null,s.ctx=[])}function dt(e,n){e.$$.dirty[0]===-1&&(le.push(e),ht(),e.$$.dirty.fill(0)),e.$$.dirty[n/31|0]|=1<<n%31}function fe(e,n,s,i,r,f,u,h=[-1]){const y=Ne;oe(e);const b=e.$$={fragment:null,ctx:null,props:f,update:P,not_equal:r,bound:G(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(y?y.$$.context:[])),callbacks:G(),dirty:h,skip_bound:!1,root:n.target||y.$$.root};u&&u(b.root);let D=!1;if(b.ctx=s?s(e,n.props||{},(O,ne,...R)=>{const Se=R.length?R[0]:ne;return b.ctx&&r(b.ctx[O],b.ctx[O]=Se)&&(!b.skip_bound&&b.bound[O]&&b.bound[O](Se),D&&dt(e,O)),ne}):[],b.update(),D=!0,se(b.before_update),b.fragment=i?i(b.ctx):!1,n.target){if(n.hydrate){const O=ct(n.target);b.fragment&&b.fragment.l(O),O.forEach($)}else b.fragment&&b.fragment.c();n.intro&&k(e.$$.fragment),Z(e,n.target,n.anchor,n.customElement),We()}oe(y)}class ce{$destroy(){J(this,1),this.$destroy=P}$on(n,s){const i=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return i.push(s),()=>{const r=i.indexOf(s);r!==-1&&i.splice(r,1)}}$set(n){this.$$set&&!st(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}}const ee=[];function te(e,n=P){let s;const i=new Set;function r(h){if(X(e,h)&&(e=h,s)){const y=!ee.length;for(const b of i)b[1](),ee.push(b,e);if(y){for(let b=0;b<ee.length;b+=2)ee[b][0](ee[b+1]);ee.length=0}}}function f(h){r(h(e))}function u(h,y=P){const b=[h,y];return i.add(b),i.size===1&&(s=n(r)||P),h(e),()=>{i.delete(b),i.size===0&&(s(),s=null)}}return{set:r,update:f,subscribe:u}}var K=(e=>(e[e.ERROR=0]="ERROR",e[e.ABORTED=1]="ABORTED",e[e.WAITING_FOR_GAME=2]="WAITING_FOR_GAME",e[e.WAITING_FOR_OPPONENT=3]="WAITING_FOR_OPPONENT",e[e.WAITING_FOR_STOCKFISH=4]="WAITING_FOR_STOCKFISH",e[e.WAITING_FOR_PLAYER=5]="WAITING_FOR_PLAYER",e))(K||{});const be=te(0),Pe=te(void 0),we=te(void 0),Ee=te(!1),Be=te(""),ue=te(2);function gt(e){let n,s;return{c(){n=lt("circle"),N(n,"cx",e[1]),N(n,"cy",e[2]),N(n,"stroke",e[0]),N(n,"opacity",s=e[3]?0:1),N(n,"r","0.4"),N(n,"stroke-width","0.1"),N(n,"fill","none")},m(i,r){B(i,n,r)},p(i,[r]){r&2&&N(n,"cx",i[1]),r&4&&N(n,"cy",i[2]),r&1&&N(n,"stroke",i[0]),r&8&&s!==(s=i[3]?0:1)&&N(n,"opacity",s)},i:P,o:P,d(i){i&&$(n)}}}function mt(e,n,s){let i;H(e,Ee,h=>s(3,i=h));let{color:r}=n,{cx:f=0}=n,{cy:u=0}=n;return e.$$set=h=>{"color"in h&&s(0,r=h.color),"cx"in h&&s(1,f=h.cx),"cy"in h&&s(2,u=h.cy)},[r,f,u,i]}class ye extends ce{constructor(n){super(),fe(this,n,mt,gt,X,{color:0,cx:1,cy:2})}}function He(e){let n,s,i,r;return n=new ye({props:{color:"green",cx:e[1].from.x,cy:e[1].from.y}}),i=new ye({props:{color:"green",cx:e[1].to.x,cy:e[1].to.y}}),{c(){x(n.$$.fragment),s=re(),x(i.$$.fragment)},m(f,u){Z(n,f,u),B(f,s,u),Z(i,f,u),r=!0},p(f,u){const h={};u&2&&(h.cx=f[1].from.x),u&2&&(h.cy=f[1].from.y),n.$set(h);const y={};u&2&&(y.cx=f[1].to.x),u&2&&(y.cy=f[1].to.y),i.$set(y)},i(f){r||(k(n.$$.fragment,f),k(i.$$.fragment,f),r=!0)},o(f){M(n.$$.fragment,f),M(i.$$.fragment,f),r=!1},d(f){J(n,f),f&&$(s),J(i,f)}}}function De(e){let n,s,i,r;return n=new ye({props:{color:"red",cx:e[0].from.x,cy:e[0].from.y}}),i=new ye({props:{color:"red",cx:e[0].to.x,cy:e[0].to.y}}),{c(){x(n.$$.fragment),s=re(),x(i.$$.fragment)},m(f,u){Z(n,f,u),B(f,s,u),Z(i,f,u),r=!0},p(f,u){const h={};u&1&&(h.cx=f[0].from.x),u&1&&(h.cy=f[0].from.y),n.$set(h);const y={};u&1&&(y.cx=f[0].to.x),u&1&&(y.cy=f[0].to.y),i.$set(y)},i(f){r||(k(n.$$.fragment,f),k(i.$$.fragment,f),r=!0)},o(f){M(n.$$.fragment,f),M(i.$$.fragment,f),r=!1},d(f){J(n,f),f&&$(s),J(i,f)}}}function pt(e){let n,s,i,r=e[1]&&He(e),f=e[0]&&De(e);return{c(){r&&r.c(),n=re(),f&&f.c(),s=qe()},m(u,h){r&&r.m(u,h),B(u,n,h),f&&f.m(u,h),B(u,s,h),i=!0},p(u,[h]){u[1]?r?(r.p(u,h),h&2&&k(r,1)):(r=He(u),r.c(),k(r,1),r.m(n.parentNode,n)):r&&(me(),M(r,1,1,()=>{r=null}),pe()),u[0]?f?(f.p(u,h),h&1&&k(f,1)):(f=De(u),f.c(),k(f,1),f.m(s.parentNode,s)):f&&(me(),M(f,1,1,()=>{f=null}),pe())},i(u){i||(k(r),k(f),i=!0)},o(u){M(r),M(f),i=!1},d(u){r&&r.d(u),u&&$(n),f&&f.d(u),u&&$(s)}}}function ve(e,n,s=!1){const i=parseInt(e.toString());let r;return n?r=s?3.5-i+1:-3.5+i-1:r=s?-3.5+i-1:3.5-i+1,r.toString()}function Ge(e){if(!e)return;const n=document.querySelector("coords.files").classList.contains("black");return{from:{x:ve(e.from.x,n,!0),y:ve(e.from.y,n)},to:{x:ve(e.to.x,n,!0),y:ve(e.to.y,n)}}}function bt(e,n,s){let i,r,f,u;return H(e,we,h=>s(2,f=h)),H(e,Pe,h=>s(3,u=h)),e.$$.update=()=>{e.$$.dirty&8&&s(1,i=Ge(u)),e.$$.dirty&4&&s(0,r=Ge(f))},[r,i,f,u]}class Et extends ce{constructor(n){super(),fe(this,n,bt,pt,X,{})}}const $t="";function Ue(e){let n,s;return{c(){n=he("span"),s=Ie(e[0])},m(i,r){B(i,n,r),Te(n,s)},p(i,r){r&1&&ut(s,i[0])},d(i){i&&$(n)}}}function yt(e){let n,s,i,r,f,u=e[1]&&Ue(e);return{c(){n=he("div"),u&&u.c(),s=re(),i=he("button"),i.textContent="Refresh",N(i,"class","svelte-1rsfdvz"),N(n,"style",e[1]),N(n,"class","svelte-1rsfdvz")},m(h,y){B(h,n,y),u&&u.m(n,null),Te(n,s),Te(n,i),r||(f=ft(i,"click",e[2]),r=!0)},p(h,[y]){h[1]?u?u.p(h,y):(u=Ue(h),u.c(),u.m(n,s)):u&&(u.d(1),u=null),y&2&&N(n,"style",h[1])},i:P,o:P,d(h){h&&$(n),u&&u.d(),r=!1,f()}}}function vt(e,n,s){let i,r,f,u,h,y;H(e,ue,R=>s(4,u=R)),H(e,be,R=>s(5,h=R)),H(e,Be,R=>s(6,y=R));function b(R){switch(R){case K.ERROR:case K.WAITING_FOR_PLAYER:return"4px";default:return"2px"}}function D(R){switch(R){case K.ERROR:return"red";case K.ABORTED:return"orange";case K.WAITING_FOR_STOCKFISH:return"yellow";default:return"black"}}function O(R){switch(R){case K.ERROR:return"ERROR";case K.ABORTED:return"ABORTED";case K.WAITING_FOR_OPPONENT:return"Waiting for opponent..";case K.WAITING_FOR_STOCKFISH:return"Waiting for stockfish..";case K.WAITING_FOR_PLAYER:return y;default:return""}}function ne(){ot(be,h=0,h),Ke.onMoveObserved()}return e.$$.update=()=>{e.$$.dirty&16&&s(3,i={"border-width":b(u),"border-color":D(u)}),e.$$.dirty&8&&s(1,r=Object.keys(i).map(R=>`--${R}:${i[R]}`).join(";")),e.$$.dirty&16&&s(0,f=O(u))},[f,r,ne,i,u]}class Qe extends ce{constructor(n){super(),fe(this,n,vt,yt,X,{})}}class St{constructor(){Y(this,"abortController")}abort(){this.abortController!==void 0&&!this.abortController.signal.aborted&&this.abortController.abort(),this.abortController=void 0}async getBestMoveBasedOnFEN(n,s){this.abortController=new AbortController;try{const r=await(await fetch("http://localhost:8080",{method:"POST",headers:{"Content-Type":"text/plain"},body:n,signal:this.abortController.signal})).text();let f={};if(r.includes("bestmove")){const u=["a","b","c","d","e","f","g","h"],h=O=>({x:u.indexOf(O[0])+1,y:O[1]}),y=O=>({from:h(O.substr(0,2)),to:h(O.substr(2))}),b=r.substr(9,4),D=r.substr(21);f={...b&&{bestmove:y(b)},...D&&{ponder:y(D)}}}return{moves:f,response:r,refMoveCounter:s}}catch(i){throw i.name==="AbortError"?{aborted:!0}:i}finally{this.abortController=void 0}}}var je={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Chess=e.validateFen=e.SQUARES=e.DEFAULT_POSITION=e.KING=e.QUEEN=e.ROOK=e.BISHOP=e.KNIGHT=e.PAWN=e.BLACK=e.WHITE=void 0,e.WHITE="w",e.BLACK="b",e.PAWN="p",e.KNIGHT="n",e.BISHOP="b",e.ROOK="r",e.QUEEN="q",e.KING="k",e.DEFAULT_POSITION="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";const n=-1,s={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"};e.SQUARES=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"];const i={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},r={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},f={b:[16,32,17,15],w:[-16,-32,-17,-15]},u={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},h=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],y=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],b={p:1,n:2,b:4,r:8,q:16,k:32},D="pnbrqkPNBRQK",O=[e.KNIGHT,e.BISHOP,e.ROOK,e.QUEEN],ne=7,R=6,Se=1,Pt=0,U={w:[{square:r.a1,flag:i.QSIDE_CASTLE},{square:r.h1,flag:i.KSIDE_CASTLE}],b:[{square:r.a8,flag:i.QSIDE_CASTLE},{square:r.h8,flag:i.KSIDE_CASTLE}]},wt={b:Se,w:R},Kt=["1-0","0-1","1/2-1/2","*"];function V(A){return A>>4}function ae(A){return A&15}function Ve(A){return"0123456789".indexOf(A)!==-1}function q(A){const t=ae(A),o=V(A);return"abcdefgh".substring(t,t+1)+"87654321".substring(o,o+1)}function Ae(A){return A===e.WHITE?e.BLACK:e.WHITE}function Xe(A){const t=[];t[0]="No errors.",t[1]="FEN string must contain six space-delimited fields.",t[2]="6th field (move number) must be a positive integer.",t[3]="5th field (half move counter) must be a non-negative integer.",t[4]="4th field (en-passant square) is invalid.",t[5]="3rd field (castling availability) is invalid.",t[6]="2nd field (side to move) is invalid.",t[7]="1st field (piece positions) does not contain 8 '/'-delimited rows.",t[8]="1st field (piece positions) is invalid [consecutive numbers].",t[9]="1st field (piece positions) is invalid [invalid piece].",t[10]="1st field (piece positions) is invalid [row too large].",t[11]="Illegal en-passant square";const o=A.split(/\s+/);if(o.length!==6)return{valid:!1,errorNumber:1,error:t[1]};const l=parseInt(o[5],10);if(isNaN(l)||l<=0)return{valid:!1,errorNumber:2,error:t[2]};const a=parseInt(o[4],10);if(isNaN(a)||a<0)return{valid:!1,errorNumber:3,error:t[3]};if(!/^(-|[abcdefgh][36])$/.test(o[3]))return{valid:!1,errorNumber:4,error:t[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(o[2]))return{valid:!1,errorNumber:5,error:t[5]};if(!/^(w|b)$/.test(o[1]))return{valid:!1,errorNumber:6,error:t[6]};const c=o[0].split("/");if(c.length!==8)return{valid:!1,errorNumber:7,error:t[7]};for(let g=0;g<c.length;g++){let _=0,d=!1;for(let E=0;E<c[g].length;E++)if(Ve(c[g][E])){if(d)return{valid:!1,errorNumber:8,error:t[8]};_+=parseInt(c[g][E],10),d=!0}else{if(!/^[prnbqkPRNBQK]$/.test(c[g][E]))return{valid:!1,errorNumber:9,error:t[9]};_+=1,d=!1}if(_!==8)return{valid:!1,errorNumber:10,error:t[10]}}return o[3][1]=="3"&&o[1]=="w"||o[3][1]=="6"&&o[1]=="b"?{valid:!1,errorNumber:11,error:t[11]}:{valid:!0,errorNumber:0,error:t[0]}}e.validateFen=Xe;function Lt(A,t){const o=A.from,l=A.to,a=A.piece;let c=0,g=0,_=0;for(let d=0,E=t.length;d<E;d++){const T=t[d].from,I=t[d].to,m=t[d].piece;a===m&&o!==T&&l===I&&(c++,V(o)===V(T)&&g++,ae(o)===ae(T)&&_++)}return c>0?g>0&&_>0?q(o):_>0?q(o).charAt(1):q(o).charAt(0):""}function Q(A,t,o,l,a,c=void 0,g=i.NORMAL){const _=V(l);if(a===e.PAWN&&(_===ne||_===Pt))for(let d=0;d<O.length;d++){const E=O[d];A.push({color:t,from:o,to:l,piece:a,captured:c,promotion:E,flags:g|i.PROMOTION})}else A.push({color:t,from:o,to:l,piece:a,captured:c,promotion:void 0,flags:g})}function xe(A){let t=A.charAt(0);return t>="a"&&t<="h"?A.match(/[a-h]\d.*[a-h]\d/)?void 0:e.PAWN:(t=t.toLowerCase(),t==="o"?e.KING:t)}function et(A){return A.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Mt{constructor(t=e.DEFAULT_POSITION){this._board=new Array(128),this._turn=e.WHITE,this._header={},this._kings={w:n,b:n},this._epSquare=-1,this._halfMoves=0,this._moveNumber=0,this._history=[],this._comments={},this._castling={w:0,b:0},this.load(t)}clear(t=!1){this._board=new Array(128),this._kings={w:n,b:n},this._turn=e.WHITE,this._castling={w:0,b:0},this._epSquare=n,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{},this._updateSetup(this.fen())}load(t,o=!1){const l=t.split(/\s+/),a=l[0];let c=0;if(!Xe(t).valid)return!1;this.clear(o);for(let g=0;g<a.length;g++){const _=a.charAt(g);if(_==="/")c+=8;else if(Ve(_))c+=parseInt(_,10);else{const d=_<"a"?e.WHITE:e.BLACK;this.put({type:_.toLowerCase(),color:d},q(c)),c++}}return this._turn=l[1],l[2].indexOf("K")>-1&&(this._castling.w|=i.KSIDE_CASTLE),l[2].indexOf("Q")>-1&&(this._castling.w|=i.QSIDE_CASTLE),l[2].indexOf("k")>-1&&(this._castling.b|=i.KSIDE_CASTLE),l[2].indexOf("q")>-1&&(this._castling.b|=i.QSIDE_CASTLE),this._epSquare=l[3]==="-"?n:r[l[3]],this._halfMoves=parseInt(l[4],10),this._moveNumber=parseInt(l[5],10),this._updateSetup(this.fen()),!0}fen(){let t=0,o="";for(let c=r.a8;c<=r.h1;c++){if(this._board[c]){t>0&&(o+=t,t=0);const{color:g,type:_}=this._board[c];o+=g===e.WHITE?_.toUpperCase():_.toLowerCase()}else t++;c+1&136&&(t>0&&(o+=t),c!==r.h1&&(o+="/"),t=0,c+=8)}let l="";this._castling[e.WHITE]&i.KSIDE_CASTLE&&(l+="K"),this._castling[e.WHITE]&i.QSIDE_CASTLE&&(l+="Q"),this._castling[e.BLACK]&i.KSIDE_CASTLE&&(l+="k"),this._castling[e.BLACK]&i.QSIDE_CASTLE&&(l+="q"),l=l||"-";const a=this._epSquare===n?"-":q(this._epSquare);return[o,this._turn,l,a,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(t){this._history.length>0||(t!==e.DEFAULT_POSITION?(this._header.SetUp="1",this._header.FEN=t):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(e.DEFAULT_POSITION)}get(t){return this._board[r[t]]||!1}put({type:t,color:o},l){if(D.indexOf(t.toLowerCase())===-1||!(l in r))return!1;const a=r[l];return t==e.KING&&!(this._kings[o]==n||this._kings[o]==a)?!1:(this._board[a]={type:t,color:o},t===e.KING&&(this._kings[o]=a),this._updateSetup(this.fen()),!0)}remove(t){const o=this.get(t);return delete this._board[r[t]],o&&o.type===e.KING&&(this._kings[o.color]=n),this._updateSetup(this.fen()),o}_attacked(t,o){for(let l=r.a8;l<=r.h1;l++){if(l&136){l+=7;continue}if(this._board[l]===void 0||this._board[l].color!==t)continue;const a=this._board[l],c=l-o,g=c+119;if(h[g]&b[a.type]){if(a.type===e.PAWN){if(c>0){if(a.color===e.WHITE)return!0}else if(a.color===e.BLACK)return!0;continue}if(a.type==="n"||a.type==="k")return!0;const _=y[g];let d=l+_,E=!1;for(;d!==o;){if(this._board[d]!=null){E=!0;break}d+=_}if(!E)return!0}}return!1}_isKingAttacked(t){return this._attacked(Ae(t),this._kings[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},o=[];let l=0,a=0;for(let c=r.a8;c<=r.h1;c++){if(a=(a+1)%2,c&136){c+=7;continue}const g=this._board[c];g&&(t[g.type]=g.type in t?t[g.type]+1:1,g.type===e.BISHOP&&o.push(a),l++)}if(l===2)return!0;if(l===3&&(t[e.BISHOP]===1||t[e.KNIGHT]===1))return!0;if(l===t[e.BISHOP]+2){let c=0;const g=o.length;for(let _=0;_<g;_++)c+=o[_];if(c===0||c===g)return!0}return!1}isThreefoldRepetition(){const t=[],o={};let l=!1;for(;;){const a=this._undoMove();if(!a)break;t.push(a)}for(;;){const a=this.fen().split(" ").slice(0,4).join(" ");o[a]=a in o?o[a]+1:1,o[a]>=3&&(l=!0);const c=t.pop();if(c)this._makeMove(c);else break}return l}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:t=!1,square:o=void 0}={}){const l=this._moves({square:o});return t?l.map(a=>this._makePretty(a)):l.map(a=>this._moveToSan(a,l))}_moves({legal:t=!0,piece:o=void 0,square:l=void 0}={}){var a;const c=l?l.toLowerCase():void 0,g=o==null?void 0:o.toLowerCase(),_=[],d=this._turn,E=Ae(d);let T=r.a8,I=r.h1,m=!1;if(c)if(c in r)T=I=r[c],m=!0;else return[];for(let p=T;p<=I;p++){if(p&136){p+=7;continue}if(!this._board[p]||this._board[p].color===E)continue;const{type:S}=this._board[p];let C;if(S===e.PAWN){if(g&&g!==S)continue;C=p+f[d][0],this._board[C]||(Q(_,d,p,C,e.PAWN),C=p+f[d][1],wt[d]===V(p)&&!this._board[C]&&Q(_,d,p,C,e.PAWN,void 0,i.BIG_PAWN));for(let L=2;L<4;L++)C=p+f[d][L],!(C&136)&&(((a=this._board[C])===null||a===void 0?void 0:a.color)===E?Q(_,d,p,C,e.PAWN,this._board[C].type,i.CAPTURE):C===this._epSquare&&Q(_,d,p,C,e.PAWN,e.PAWN,i.EP_CAPTURE))}else{if(g&&g!==S)continue;for(let L=0,ie=u[S].length;L<ie;L++){const v=u[S][L];for(C=p;C+=v,!(C&136);){if(!this._board[C])Q(_,d,p,C,S);else{if(this._board[C].color===d)break;Q(_,d,p,C,S,this._board[C].type,i.CAPTURE);break}if(S===e.KNIGHT||S===e.KING)break}}}}if((g===void 0||g===e.KING)&&(!m||I===this._kings[d])){if(this._castling[d]&i.KSIDE_CASTLE){const p=this._kings[d],S=p+2;!this._board[p+1]&&!this._board[S]&&!this._attacked(E,this._kings[d])&&!this._attacked(E,p+1)&&!this._attacked(E,S)&&Q(_,d,this._kings[d],S,e.KING,void 0,i.KSIDE_CASTLE)}if(this._castling[d]&i.QSIDE_CASTLE){const p=this._kings[d],S=p-2;!this._board[p-1]&&!this._board[p-2]&&!this._board[p-3]&&!this._attacked(E,this._kings[d])&&!this._attacked(E,p-1)&&!this._attacked(E,S)&&Q(_,d,this._kings[d],S,e.KING,void 0,i.QSIDE_CASTLE)}}if(!t)return _;const w=[];for(let p=0,S=_.length;p<S;p++)this._makeMove(_[p]),this._isKingAttacked(d)||w.push(_[p]),this._undoMove();return w}move(t,{sloppy:o=!1}={}){let l=null;if(typeof t=="string")l=this._moveFromSan(t,o);else if(typeof t=="object"){const c=this._moves();for(let g=0,_=c.length;g<_;g++)if(t.from===q(c[g].from)&&t.to===q(c[g].to)&&(!("promotion"in c[g])||t.promotion===c[g].promotion)){l=c[g];break}}if(!l)return null;const a=this._makePretty(l);return this._makeMove(l),a}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(t){const o=this._turn,l=Ae(o);if(this._push(t),this._board[t.to]=this._board[t.from],delete this._board[t.from],t.flags&i.EP_CAPTURE&&(this._turn===e.BLACK?delete this._board[t.to-16]:delete this._board[t.to+16]),t.promotion&&(this._board[t.to]={type:t.promotion,color:o}),this._board[t.to].type===e.KING){if(this._kings[o]=t.to,t.flags&i.KSIDE_CASTLE){const a=t.to-1,c=t.to+1;this._board[a]=this._board[c],delete this._board[c]}else if(t.flags&i.QSIDE_CASTLE){const a=t.to+1,c=t.to-2;this._board[a]=this._board[c],delete this._board[c]}this._castling[o]=0}if(this._castling[o]){for(let a=0,c=U[o].length;a<c;a++)if(t.from===U[o][a].square&&this._castling[o]&U[o][a].flag){this._castling[o]^=U[o][a].flag;break}}if(this._castling[l]){for(let a=0,c=U[l].length;a<c;a++)if(t.to===U[l][a].square&&this._castling[l]&U[l][a].flag){this._castling[l]^=U[l][a].flag;break}}t.flags&i.BIG_PAWN?o===e.BLACK?this._epSquare=t.to-16:this._epSquare=t.to+16:this._epSquare=n,t.piece===e.PAWN?this._halfMoves=0:t.flags&(i.CAPTURE|i.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,o===e.BLACK&&this._moveNumber++,this._turn=l}undo(){const t=this._undoMove();return t?this._makePretty(t):null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;const o=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber;const l=this._turn,a=Ae(l);if(this._board[o.from]=this._board[o.to],this._board[o.from].type=o.piece,delete this._board[o.to],o.captured)if(o.flags&i.EP_CAPTURE){let c;l===e.BLACK?c=o.to-16:c=o.to+16,this._board[c]={type:e.PAWN,color:a}}else this._board[o.to]={type:o.captured,color:a};if(o.flags&(i.KSIDE_CASTLE|i.QSIDE_CASTLE)){let c,g;o.flags&i.KSIDE_CASTLE?(c=o.to+1,g=o.to-1):(c=o.to-2,g=o.to+1),this._board[c]=this._board[g],delete this._board[g]}return o}pgn({newline:t=`
`,maxWidth:o=0}={}){const l=[];let a=!1;for(const m in this._header)l.push("["+m+' "'+this._header[m]+'"]'+t),a=!0;a&&this._history.length&&l.push(t);const c=m=>{const w=this._comments[this.fen()];if(typeof w<"u"){const p=m.length>0?" ":"";m=`${m}${p}{${w}}`}return m},g=[];for(;this._history.length>0;)g.push(this._undoMove());const _=[];let d="";for(g.length===0&&_.push(c(""));g.length>0;){d=c(d);const m=g.pop();if(!m)break;if(!this._history.length&&m.color==="b"){const w=`${this._moveNumber}. ...`;d=d?`${d} ${w}`:w}else m.color==="w"&&(d.length&&_.push(d),d=this._moveNumber+".");d=d+" "+this._moveToSan(m,this._moves({legal:!0})),this._makeMove(m)}if(d.length&&_.push(c(d)),typeof this._header.Result<"u"&&_.push(this._header.Result),o===0)return l.join("")+_.join(" ");const E=function(){return l.length>0&&l[l.length-1]===" "?(l.pop(),!0):!1},T=function(m,w){for(const p of w.split(" "))if(!!p){if(m+p.length>o){for(;E();)m--;l.push(t),m=0}l.push(p),m+=p.length,l.push(" "),m++}return E()&&m--,m};let I=0;for(let m=0;m<_.length;m++){if(I+_[m].length>o&&_[m].includes("{")){I=T(I,_[m]);continue}I+_[m].length>o&&m!==0?(l[l.length-1]===" "&&l.pop(),l.push(t),I=0):m!==0&&(l.push(" "),I++),l.push(_[m]),I+=_[m].length}return l.join("")}header(...t){for(let o=0;o<t.length;o+=2)typeof t[o]=="string"&&typeof t[o+1]=="string"&&(this._header[t[o]]=t[o+1]);return this._header}loadPgn(t,{sloppy:o=!1,newlineChar:l=`\r?
`}={}){function a(v){return v.replace(/\\/g,"\\")}function c(v){const F={},j=v.split(new RegExp(a(l)));let Le="",tt="";for(let Ce=0;Ce<j.length;Ce++){const nt=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;Le=j[Ce].replace(nt,"$1"),tt=j[Ce].replace(nt,"$2"),Le.trim().length>0&&(F[Le]=tt)}return F}t=t.trim();const _=new RegExp("^(\\[((?:"+a(l)+")|.)*\\])(?:\\s*"+a(l)+"){2}").exec(t),d=_&&_.length>=2?_[1]:"";this.reset();const E=c(d);let T="";for(const v in E)v.toLowerCase()==="fen"&&(T=E[v]),this.header(v,E[v]);if(o){if(T&&!this.load(T,!0))return!1}else if(E.SetUp==="1"&&!("FEN"in E&&this.load(E.FEN,!0)))return!1;function I(v){return Array.from(v).map(function(F){return F.charCodeAt(0)<128?F.charCodeAt(0).toString(16):encodeURIComponent(F).replace(/%/g,"").toLowerCase()}).join("")}function m(v){return v.length==0?"":decodeURIComponent("%"+(v.match(/.{1,2}/g)||[]).join("%"))}const w=function(v){return v=v.replace(new RegExp(a(l),"g")," "),`{${I(v.slice(1,v.length-1))}}`},p=function(v){if(v.startsWith("{")&&v.endsWith("}"))return m(v.slice(1,v.length-1))};let S=t.replace(d,"").replace(new RegExp(`({[^}]*})+?|;([^${a(l)}]*)`,"g"),function(v,F,j){return F!==void 0?w(F):" "+w(`{${j.slice(1)}}`)}).replace(new RegExp(a(l),"g")," ");const C=/(\([^()]+\))+?/g;for(;C.test(S);)S=S.replace(C,"");S=S.replace(/\d+\.(\.\.)?/g,""),S=S.replace(/\.\.\./g,""),S=S.replace(/\$\d+/g,"");let L=S.trim().split(new RegExp(/\s+/));L=L.join(",").replace(/,,+/g,",").split(",");let ie="";for(let v=0;v<L.length;v++){const F=p(L[v]);if(F!==void 0){this._comments[this.fen()]=F;continue}const j=this._moveFromSan(L[v],o);if(j==null)if(Kt.indexOf(L[v])>-1)ie=L[v];else return!1;else ie="",this._makeMove(j)}return ie&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",ie),!0}_moveToSan(t,o){let l="";if(t.flags&i.KSIDE_CASTLE)l="O-O";else if(t.flags&i.QSIDE_CASTLE)l="O-O-O";else{if(t.piece!==e.PAWN){const a=Lt(t,o);l+=t.piece.toUpperCase()+a}t.flags&(i.CAPTURE|i.EP_CAPTURE)&&(t.piece===e.PAWN&&(l+=q(t.from)[0]),l+="x"),l+=q(t.to),t.promotion&&(l+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?l+="#":l+="+"),this._undoMove(),l}_moveFromSan(t,o=!1){const l=et(t);let a=xe(l),c=this._moves({legal:!0,piece:a});for(let m=0,w=c.length;m<w;m++)if(l===et(this._moveToSan(c[m],c)))return c[m];if(!o)return null;let g,_,d,E,T,I=!1;_=l.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),_?(g=_[1],d=_[2],E=_[3],T=_[4],d.length==1&&(I=!0)):(_=l.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),_&&(g=_[1],d=_[2],E=_[3],T=_[4],d.length==1&&(I=!0))),a=xe(l),c=this._moves({legal:!0,piece:g||a});for(let m=0,w=c.length;m<w;m++)if(d&&E){if((!g||g.toLowerCase()==c[m].piece)&&r[d]==c[m].from&&r[E]==c[m].to&&(!T||T.toLowerCase()==c[m].promotion))return c[m];if(I){const p=q(c[m].from);if((!g||g.toLowerCase()==c[m].piece)&&r[E]==c[m].to&&(d==p[0]||d==p[1])&&(!T||T.toLowerCase()==c[m].promotion))return c[m]}}return null}ascii(){let t=`   +------------------------+
`;for(let o=r.a8;o<=r.h1;o++){if(ae(o)===0&&(t+=" "+"87654321"[V(o)]+" |"),this._board[o]){const l=this._board[o].type,c=this._board[o].color===e.WHITE?l.toUpperCase():l.toLowerCase();t+=" "+c+" "}else t+=" . ";o+1&136&&(t+=`|
`,o+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const o=this._moves({legal:!1});let l=0;const a=this._turn;for(let c=0,g=o.length;c<g;c++)this._makeMove(o[c]),this._isKingAttacked(a)||(t-1>0?l+=this.perft(t-1):l++),this._undoMove();return l}_makePretty(t){const{color:o,piece:l,from:a,to:c,flags:g,captured:_,promotion:d}=t;let E="";for(const I in i)i[I]&g&&(E+=s[I]);const T={color:o,piece:l,from:q(a),to:q(c),san:this._moveToSan(t,this._moves({legal:!0})),flags:E};return _&&(T.captured=_),d&&(T.promotion=d),T}turn(){return this._turn}board(){const t=[];let o=[];for(let l=r.a8;l<=r.h1;l++)this._board[l]==null?o.push(null):o.push({square:q(l),type:this._board[l].type,color:this._board[l].color}),l+1&136&&(t.push(o),o=[],l+=8);return t}squareColor(t){if(t in r){const o=r[t];return(V(o)+ae(o))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const o=[],l=[];for(;this._history.length>0;)o.push(this._undoMove());for(;;){const a=o.pop();if(!a)break;t?l.push(this._makePretty(a)):l.push(this._moveToSan(a,this._moves())),this._makeMove(a)}return l}_pruneComments(){const t=[],o={},l=a=>{a in this._comments&&(o[a]=this._comments[a])};for(;this._history.length>0;)t.push(this._undoMove());for(l(this.fen());;){const a=t.pop();if(!a)break;this._makeMove(a),l(this.fen())}this._comments=o}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const o=this._comments[t];return delete this._comments[t],{fen:t,comment:o}})}}e.Chess=Mt})(je);class Ye{constructor(){Y(this,"_stockfish",new St);Y(this,"moveCounter",0);be.subscribe(n=>this.moveCounter=n)}mount(){new Promise(()=>new this.Highlights({target:this.highlightsTarget})),new Promise(()=>new this.Status({target:this.statusTarget})),this.onMoveObserved(),this.startObservingMoves()}async onMoveObserved(){be.set(++this.moveCounter);try{this._stockfish.abort(),this.moveCounter%2?await this.onPlayerTurn():this.onOpponentTurn()}catch(n){if(!n.stale&&(ue.set(n.aborted?K.ABORTED:K.ERROR),!n.aborted))throw n}}startObservingMoves(){new MutationObserver(()=>{this.onMoveObserved()}).observe(this.movesContainer,{childList:!0,subtree:!0})}async onPlayerTurn(){ue.set(K.WAITING_FOR_STOCKFISH);const n=new je.Chess;for(const r of this.scrapeMoves())n.move(r);const s=await this._stockfish.getBestMoveBasedOnFEN(n.fen(),this.moveCounter),i=this.moveCounter!==s.refMoveCounter;if(i)throw{stale:i};ue.set(K.WAITING_FOR_PLAYER),Be.set(s.response),s.moves&&(Pe.set(s.moves.bestmove),we.set(s.moves.ponder),Ee.set(!1))}onOpponentTurn(){ue.set(K.WAITING_FOR_OPPONENT),Ee.set(!0)}}class At extends Ye{constructor(){super(...arguments);Y(this,"Highlights",Et);Y(this,"Status",Qe)}get highlightsTarget(){const s=document.querySelector("cg-container svg.cg-shapes g");if(!s)throw new Error("Highlights target not found");return s}get movesContainer(){return document.querySelector("l4x")}get statusTarget(){const s=document.querySelector(".round__app.variant-standard");if(!s)throw new Error("Status target not found");return s}isGame(){var r;const s=document.querySelector(".message > div:nth-child(1)"),i=s&&((r=s.textContent)==null?void 0:r.includes("It's your turn!"))||!1;return!!document.querySelector("l4x")||i}scrapeMoves(){let s=[];for(const i of document.querySelectorAll("l4x u8t"))i.textContent&&s.push(i.textContent);return s}}const Wt="";function Ct(e){let n,s;return{c(){n=he("div"),N(n,"class",s=Me(e[0])+" svelte-15mzqdd"),N(n,"style",e[1])},m(i,r){B(i,n,r)},p(i,[r]){r&1&&s!==(s=Me(i[0])+" svelte-15mzqdd")&&N(n,"class",s),r&2&&N(n,"style",i[1])},i:P,o:P,d(i){i&&$(n)}}}function Tt(e,n,s){let i,r,f;H(e,Ee,b=>s(5,f=b));let{color:u}=n,{x:h,y}=n;return e.$$set=b=>{"color"in b&&s(2,u=b.color),"x"in b&&s(3,h=b.x),"y"in b&&s(4,y=b.y)},e.$$.update=()=>{e.$$.dirty&36&&s(1,i=`--highlight-color:${u};--highligh-opacity:${f?0:.5}`),e.$$.dirty&24&&s(0,r=`highlight square-${h}${y}`)},[r,i,u,h,y,f]}class ze extends ce{constructor(n){super(),fe(this,n,Tt,Ct,X,{color:2,x:3,y:4})}}function Ze(e){let n,s;return n=new ze({props:{color:"green",x:e[0].from.x,y:e[0].from.y}}),{c(){x(n.$$.fragment)},m(i,r){Z(n,i,r),s=!0},p(i,r){const f={};r&1&&(f.x=i[0].from.x),r&1&&(f.y=i[0].from.y),n.$set(f)},i(i){s||(k(n.$$.fragment,i),s=!0)},o(i){M(n.$$.fragment,i),s=!1},d(i){J(n,i)}}}function Je(e){let n,s;return n=new ze({props:{color:"red",x:e[1].from.x,y:e[1].from.y}}),{c(){x(n.$$.fragment)},m(i,r){Z(n,i,r),s=!0},p(i,r){const f={};r&2&&(f.x=i[1].from.x),r&2&&(f.y=i[1].from.y),n.$set(f)},i(i){s||(k(n.$$.fragment,i),s=!0)},o(i){M(n.$$.fragment,i),s=!1},d(i){J(n,i)}}}function It(e){let n,s,i,r=e[0]&&Ze(e),f=e[1]&&Je(e);return{c(){r&&r.c(),n=re(),f&&f.c(),s=qe()},m(u,h){r&&r.m(u,h),B(u,n,h),f&&f.m(u,h),B(u,s,h),i=!0},p(u,[h]){u[0]?r?(r.p(u,h),h&1&&k(r,1)):(r=Ze(u),r.c(),k(r,1),r.m(n.parentNode,n)):r&&(me(),M(r,1,1,()=>{r=null}),pe()),u[1]?f?(f.p(u,h),h&2&&k(f,1)):(f=Je(u),f.c(),k(f,1),f.m(s.parentNode,s)):f&&(me(),M(f,1,1,()=>{f=null}),pe())},i(u){i||(k(r),k(f),i=!0)},o(u){M(r),M(f),i=!1},d(u){r&&r.d(u),u&&$(n),f&&f.d(u),u&&$(s)}}}function Nt(e,n,s){let i,r;return H(e,Pe,f=>s(0,i=f)),H(e,we,f=>s(1,r=f)),[i,r]}class kt extends ce{constructor(n){super(),fe(this,n,Nt,It,X,{})}}class Ot extends Ye{constructor(){super(...arguments);Y(this,"Highlights",kt);Y(this,"Status",Qe)}get highlightsTarget(){const s=document.querySelector("chess-board");if(!s)throw new Error("Highlights target not found");return s}get movesContainer(){return document.querySelector("vertical-move-list")}get statusTarget(){const s=document.querySelector(".play-controller-message");if(!s)throw new Error("Status target not found");return s}isGame(){return!!document.querySelector("vertical-move-list")}scrapeMoves(){let s=[];for(const i of document.querySelectorAll(".move .node"))i.textContent&&s.push(i.textContent);return s}}const Ke=window.location.host==="lichess.org"?new At:new Ot,Rt=setInterval(()=>{Ke.isGame()&&(clearInterval(Rt),Ke.mount())},1e3)})();
