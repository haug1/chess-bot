var qt=Object.defineProperty;var Tt=(p,v,E)=>v in p?qt(p,v,{enumerable:!0,configurable:!0,writable:!0,value:E}):p[v]=E;var M=(p,v,E)=>(Tt(p,typeof v!="symbol"?v+"":v,E),E);(function(){"use strict";function p(){}function v(e){return e()}function E(){return Object.create(null)}function W(e){e.forEach(v)}function ge(e){return typeof e=="function"}function A(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Ge(e){return Object.keys(e).length===0}function We(e,...t){if(e==null)return p;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function j(e,t,n){e.$$.on_destroy.push(We(t,n))}function me(e){return e??""}"WeakMap"in(typeof window<"u"?window:typeof globalThis<"u"?globalThis:global);function N(e,t){e.appendChild(t)}function b(e,t,n){e.insertBefore(t,n||null)}function _(e){e.parentNode&&e.parentNode.removeChild(e)}function V(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function F(e){return document.createElement(e)}function Fe(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Y(e){return document.createTextNode(e)}function C(){return Y(" ")}function K(){return Y("")}function De(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Je(e){return Array.from(e.childNodes)}function ye(e,t){t=""+t,e.data!==t&&(e.data=t)}let re;function D(e){re=e}const B=[],pe=[];let I=[];const _e=[],Ue=Promise.resolve();let se=!1;function Ve(){se||(se=!0,Ue.then(be))}function ie(e){I.push(e)}const le=new Set;let L=0;function be(){if(L!==0)return;const e=re;do{try{for(;L<B.length;){const t=B[L];L++,D(t),Ye(t.$$)}}catch(t){throw B.length=0,L=0,t}for(D(null),B.length=0,L=0;pe.length;)pe.pop()();for(let t=0;t<I.length;t+=1){const n=I[t];le.has(n)||(le.add(n),n())}I.length=0}while(B.length);for(;_e.length;)_e.pop()();se=!1,le.clear(),D(e)}function Ye(e){if(e.fragment!==null){e.update(),W(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ie)}}function Ke(e){const t=[],n=[];I.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),I=t}const Q=new Set;let H;function O(){H={r:0,c:[],p:H}}function S(){H.r||W(H.c),H=H.p}function d(e,t){e&&e.i&&(Q.delete(e),e.i(t))}function g(e,t,n,o){if(e&&e.o){if(Q.has(e))return;Q.add(e),H.c.push(()=>{Q.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}[...["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]];function x(e){e&&e.c()}function w(e,t,n,o){const{fragment:i,after_update:r}=e.$$;i&&i.m(t,n),o||ie(()=>{const c=e.$$.on_mount.map(v).filter(ge);e.$$.on_destroy?e.$$.on_destroy.push(...c):W(c),e.$$.on_mount=[]}),r.forEach(ie)}function $(e,t){const n=e.$$;n.fragment!==null&&(Ke(n.after_update),W(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Qe(e,t){e.$$.dirty[0]===-1&&(B.push(e),Ve(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function J(e,t,n,o,i,r,c,l=[-1]){const s=re;D(e);const a=e.$$={fragment:null,ctx:[],props:r,update:p,not_equal:i,bound:E(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(s?s.$$.context:[])),callbacks:E(),dirty:l,skip_bound:!1,root:t.target||s.$$.root};c&&c(a.root);let f=!1;if(a.ctx=n?n(e,t.props||{},(h,u,...y)=>{const q=y.length?y[0]:u;return a.ctx&&i(a.ctx[h],a.ctx[h]=q)&&(!a.skip_bound&&a.bound[h]&&a.bound[h](q),f&&Qe(e,h)),u}):[],a.update(),f=!0,W(a.before_update),a.fragment=o?o(a.ctx):!1,t.target){if(t.hydrate){const h=Je(t.target);a.fragment&&a.fragment.l(h),h.forEach(_)}else a.fragment&&a.fragment.c();t.intro&&d(e.$$.fragment),w(e,t.target,t.anchor,t.customElement),be()}D(s)}class U{$destroy(){$(this,1),this.$destroy=p}$on(t,n){if(!ge(n))return p;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!Ge(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Ze(e){let t;return{c(){t=Fe("circle"),m(t,"cx",e[1]),m(t,"cy",e[2]),m(t,"stroke",e[0]),m(t,"opacity","1"),m(t,"r","0.4"),m(t,"stroke-width","0.1"),m(t,"fill","none")},m(n,o){b(n,t,o)},p(n,[o]){o&2&&m(t,"cx",n[1]),o&4&&m(t,"cy",n[2]),o&1&&m(t,"stroke",n[0])},i:p,o:p,d(n){n&&_(t)}}}function Xe(e,t,n){let{color:o}=t,{x:i=0}=t,{y:r=0}=t;return e.$$set=c=>{"color"in c&&n(0,o=c.color),"x"in c&&n(1,i=c.x),"y"in c&&n(2,r=c.y)},[o,i,r]}let Z=class extends U{constructor(t){super(),J(this,t,Xe,Ze,A,{color:0,x:1,y:2})}};const z=[];function X(e,t=p){let n;const o=new Set;function i(l){if(A(e,l)&&(e=l,n)){const s=!z.length;for(const a of o)a[1](),z.push(a,e);if(s){for(let a=0;a<z.length;a+=2)z[a][0](z[a+1]);z.length=0}}}function r(l){i(l(e))}function c(l,s=p){const a=[l,s];return o.add(a),o.size===1&&(n=t(i)||p),l(e),()=>{o.delete(a),o.size===0&&n&&(n(),n=null)}}return{set:i,update:r,subscribe:c}}const ve=X(""),P=X([]),G=X([]),we=X("");function R(e){switch(e){case 0:return"rgba(0,255,0,1)";case 1:return"rgba(212,245,66,1)";default:return"rgba(212,245,66,0.5)"}}function ee(e){switch(e){case 0:return"rgba(255,0,0,1)";case 1:return"rgba(245,105,66,1)";case 2:default:return"rgba(245,105,66,0.5)"}}function $e(e,t){return e.x===t.x&&e.y===t.y}function k(e,t){return!t.some(n=>$e(e,n.from)||$e(e,n.to))}function Me(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Ee(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Ce(e){let t,n,o,i;return t=new Z({props:{color:R(e[6]),x:e[4].from.x,y:e[4].from.y}}),o=new Z({props:{color:R(e[6]),x:e[4].to.x,y:e[4].to.y}}),{c(){x(t.$$.fragment),n=C(),x(o.$$.fragment)},m(r,c){w(t,r,c),b(r,n,c),w(o,r,c),i=!0},p(r,c){const l={};c&2&&(l.x=r[4].from.x),c&2&&(l.y=r[4].from.y),t.$set(l);const s={};c&2&&(s.x=r[4].to.x),c&2&&(s.y=r[4].to.y),o.$set(s)},i(r){i||(d(t.$$.fragment,r),d(o.$$.fragment,r),i=!0)},o(r){g(t.$$.fragment,r),g(o.$$.fragment,r),i=!1},d(r){$(t,r),r&&_(n),$(o,r)}}}function Oe(e){let t,n;return t=new Z({props:{color:ee(e[6]),x:e[4].from.x,y:e[4].from.y}}),{c(){x(t.$$.fragment)},m(o,i){w(t,o,i),n=!0},p(o,i){const r={};i&1&&(r.x=o[4].from.x),i&1&&(r.y=o[4].from.y),t.$set(r)},i(o){n||(d(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){$(t,o)}}}function Se(e){let t,n;return t=new Z({props:{color:ee(e[6]),x:e[4].to.x,y:e[4].to.y}}),{c(){x(t.$$.fragment)},m(o,i){w(t,o,i),n=!0},p(o,i){const r={};i&1&&(r.x=o[4].to.x),i&1&&(r.y=o[4].to.y),t.$set(r)},i(o){n||(d(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){$(t,o)}}}function xe(e){let t=k(e[4].from,e[1]),n,o=k(e[4].to,e[0]),i,r,c=t&&Oe(e),l=o&&Se(e);return{c(){c&&c.c(),n=C(),l&&l.c(),i=K()},m(s,a){c&&c.m(s,a),b(s,n,a),l&&l.m(s,a),b(s,i,a),r=!0},p(s,a){a&3&&(t=k(s[4].from,s[1])),t?c?(c.p(s,a),a&3&&d(c,1)):(c=Oe(s),c.c(),d(c,1),c.m(n.parentNode,n)):c&&(O(),g(c,1,1,()=>{c=null}),S()),a&1&&(o=k(s[4].to,s[0])),o?l?(l.p(s,a),a&1&&d(l,1)):(l=Se(s),l.c(),d(l,1),l.m(i.parentNode,i)):l&&(O(),g(l,1,1,()=>{l=null}),S())},i(s){r||(d(c),d(l),r=!0)},o(s){g(c),g(l),r=!1},d(s){c&&c.d(s),s&&_(n),l&&l.d(s),s&&_(i)}}}function Re(e){let t,n,o,i=e[1],r=[];for(let f=0;f<i.length;f+=1)r[f]=Ce(Ee(e,i,f));const c=f=>g(r[f],1,1,()=>{r[f]=null});let l=e[0],s=[];for(let f=0;f<l.length;f+=1)s[f]=xe(Me(e,l,f));const a=f=>g(s[f],1,1,()=>{s[f]=null});return{c(){for(let f=0;f<r.length;f+=1)r[f].c();t=C();for(let f=0;f<s.length;f+=1)s[f].c();n=K()},m(f,h){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(f,h);b(f,t,h);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(f,h);b(f,n,h),o=!0},p(f,[h]){if(h&2){i=f[1];let u;for(u=0;u<i.length;u+=1){const y=Ee(f,i,u);r[u]?(r[u].p(y,h),d(r[u],1)):(r[u]=Ce(y),r[u].c(),d(r[u],1),r[u].m(t.parentNode,t))}for(O(),u=i.length;u<r.length;u+=1)c(u);S()}if(h&3){l=f[0];let u;for(u=0;u<l.length;u+=1){const y=Me(f,l,u);s[u]?(s[u].p(y,h),d(s[u],1)):(s[u]=xe(y),s[u].c(),d(s[u],1),s[u].m(n.parentNode,n))}for(O(),u=l.length;u<s.length;u+=1)a(u);S()}},i(f){if(!o){for(let h=0;h<i.length;h+=1)d(r[h]);for(let h=0;h<l.length;h+=1)d(s[h]);o=!0}},o(f){r=r.filter(Boolean);for(let h=0;h<r.length;h+=1)g(r[h]);s=s.filter(Boolean);for(let h=0;h<s.length;h+=1)g(s[h]);o=!1},d(f){V(r,f),f&&_(t),V(s,f),f&&_(n)}}}function te(e,t,n=!1){const o=parseInt(e.toString());let i;return t?i=n?3.5-o+1:-3.5+o-1:i=n?-3.5+o-1:3.5-o+1,i.toString()}function ke(e){const t=document.querySelector("coords.files").classList.contains("black");return{from:{x:te(e.from.x,t,!0),y:te(e.from.y,t)},to:{x:te(e.to.x,t,!0),y:te(e.to.y,t)}}}function et(e,t,n){let o,i,r,c;return j(e,G,l=>n(2,r=l)),j(e,P,l=>n(3,c=l)),e.$$.update=()=>{e.$$.dirty&8&&n(1,o=c.map(l=>ke(l))),e.$$.dirty&4&&n(0,i=r.map(l=>ke(l)))},[i,o,r,c]}let tt=class extends U{constructor(t){super(),J(this,t,et,Re,A,{})}};async function nt(e,t){const n=e.getReader();let o;for(;!(o=await n.read()).done;)t(o.value)}function ot(e){let t,n,o,i=!1;return function(c){t===void 0?(t=c,n=0,o=-1):t=st(t,c);const l=t.length;let s=0;for(;n<l;){i&&(t[n]===10&&(s=++n),i=!1);let a=-1;for(;n<l&&a===-1;++n)switch(t[n]){case 58:o===-1&&(o=n-s);break;case 13:i=!0;case 10:a=n;break}if(a===-1)break;e(t.subarray(s,a),o),s=n,o=-1}s===l?t=void 0:s!==0&&(t=t.subarray(s),n-=s)}}function rt(e,t,n){let o=qe();const i=new TextDecoder;return function(c,l){if(c.length===0)n==null||n(o),o=qe();else if(l>0){const s=i.decode(c.subarray(0,l)),a=l+(c[l+1]===32?2:1),f=i.decode(c.subarray(a));switch(s){case"data":o.data=o.data?o.data+`
`+f:f;break;case"event":o.event=f;break;case"id":e(o.id=f);break;case"retry":const h=parseInt(f,10);isNaN(h)||t(o.retry=h);break}}}}function st(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function qe(){return{data:"",event:"",id:"",retry:void 0}}var it=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};const ce="text/event-stream",lt=1e3,Te="last-event-id";function ct(e,t){var{signal:n,headers:o,onopen:i,onmessage:r,onclose:c,onerror:l,openWhenHidden:s,fetch:a}=t,f=it(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((h,u)=>{const y=Object.assign({},o);y.accept||(y.accept=ce);let q;function ze(){q.abort(),document.hidden||he()}s||document.addEventListener("visibilitychange",ze);let Pe=lt,ue=0;function ae(){document.removeEventListener("visibilitychange",ze),window.clearTimeout(ue),q.abort()}n==null||n.addEventListener("abort",()=>{ae(),h()});const xt=a??window.fetch,kt=i??ft;async function he(){var de;q=new AbortController;try{const oe=await xt(e,Object.assign(Object.assign({},f),{headers:y,signal:q.signal}));await kt(oe),await nt(oe.body,ot(rt(T=>{T?y[Te]=T:delete y[Te]},T=>{Pe=T},r))),c==null||c(),ae(),h()}catch(oe){if(!q.signal.aborted)try{const T=(de=l==null?void 0:l(oe))!==null&&de!==void 0?de:Pe;window.clearTimeout(ue),ue=window.setTimeout(he,T)}catch(T){ae(),u(T)}}}he()})}function ft(e){const t=e.headers.get("content-type");if(!(t!=null&&t.startsWith(ce)))throw new Error(`Expected content-type to be ${ce}, Actual: ${t}`)}class ut{constructor(){M(this,"abortController")}abort(){this.abortController!==void 0&&!this.abortController.signal.aborted&&this.abortController.abort(),this.abortController=void 0}getEvaluation(t,n,o){this.abortController=new AbortController;const i=this.abortController.signal,r=this.abort;return new Promise(async(c,l)=>{try{await ct("http://localhost:8080/moves/sse",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({moves:t}),signal:i,async onmessage(s){try{const a={...JSON.parse(s.data),refMoveCounter:n};await o(a)}catch(a){r(),l(a)}},onerror(s){l(s)},openWhenHidden:!0}),c()}catch(s){l(s)}})}}const At="";function at(e){let t,n,o,i,r,c,l,s,a,f;return{c(){t=F("div"),n=F("button"),n.textContent="Refresh",o=C(),i=F("span"),r=Y(e[0]),c=C(),l=F("span"),s=Y(e[1]),m(n,"class","svelte-qztgd4"),m(i,"class","svelte-qztgd4"),m(l,"class","svelte-qztgd4"),m(t,"style",e[2]),m(t,"class","svelte-qztgd4")},m(h,u){b(h,t,u),N(t,n),N(t,o),N(t,i),N(i,r),N(t,c),N(t,l),N(l,s),a||(f=De(n,"click",e[3]),a=!0)},p(h,[u]){u&1&&ye(r,h[0]),u&2&&ye(s,h[1]),u&4&&m(t,"style",h[2])},i:p,o:p,d(h){h&&_(t),a=!1,f()}}}function ht(e){return e==="GG"?"green":"black"}function dt(e,t){return t=="GG"?t:e}function gt(e,t,n){let o,i,r,c,l;j(e,ve,a=>n(0,c=a)),j(e,we,a=>n(5,l=a));function s(){fe.resync()}return e.$$.update=()=>{e.$$.dirty&1&&n(4,o={"border-color":ht(c)}),e.$$.dirty&16&&n(2,i=Object.keys(o).map(a=>`--${a}:${o[a]}`).join(";")),e.$$.dirty&33&&n(1,r=dt(l,c))},[c,r,i,s,o,l]}class mt extends U{constructor(t){super(),J(this,t,gt,at,A,{})}}const yt=(e,t)=>e.from.x!==t.from.x||e.from.y!==t.from.y||e.to.x!==t.to.x||e.to.y!==t.to.y,pt=(e,t)=>e.from.x===t.from.x&&e.from.y===t.from.y&&e.to.x===t.to.x&&e.to.y===t.to.y;class Ne{constructor(){M(this,"_stockfish",new ut);M(this,"moveCounter",0);M(this,"moveObserver");M(this,"friendlyMoves");M(this,"enemyMoves");P.subscribe(t=>this.friendlyMoves=t),G.subscribe(t=>this.enemyMoves=t)}mount(){new Promise(()=>new this.Highlights({target:this.highlightsTarget})),new Promise(()=>new mt({target:this.statusTarget})),this.onMoveObserved(),this.startObservingMoves()}resync(){this.moveCounter=0,this.moveObserver&&(this.moveObserver.disconnect(),this.moveObserver=void 0),this.onMoveObserved(),this.startObservingMoves()}async onMoveObserved(){++this.moveCounter,P.set([]),G.set([]),this._stockfish.abort(),await this.handleTurn(this.moveCounter%2!==0)}startObservingMoves(){this.moveObserver=new MutationObserver(()=>{this.onMoveObserved()}),this.moveObserver.observe(this.movesContainer,{childList:!0,subtree:!0})}addTopMove(t,n,o){t.set([n,...o.filter(_t(n)).slice(0,1)])}async handleTurn(t){try{await this._stockfish.getEvaluation(this.scrapeMoves(),this.moveCounter,n=>{const o=this.moveCounter!==n.refMoveCounter;if(o)throw{stale:o};if(we.set(n.raw),n.bestmove){const i=t?n.bestmove.bestmove:n.bestmove.ponder,r=t?n.bestmove.ponder:n.bestmove.bestmove;i&&this.addTopMove(P,i,this.friendlyMoves),r&&this.addTopMove(G,r,this.enemyMoves)}if(n.evaluation){const i=t?n.evaluation.friendly:n.evaluation.enemy,r=t?n.evaluation.enemy:n.evaluation.friendly;i&&this.addTopMove(P,i,this.friendlyMoves),r&&this.addTopMove(G,r,this.enemyMoves)}n.score&&ve.set(n.score)})}catch(n){if(!n.stale&&!n.aborted)throw n}}}function _t(e){return(t,n,o)=>{const i=yt(t,e),c=o.findIndex(l=>pt(t,l))===n;return i&&c}}function bt(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("class","cg-shapes"),e.setAttribute("viewBox","-4 -4 8 8"),e.setAttribute("preserveAspectRatio","xMidYMid slice"),e}class vt extends Ne{constructor(){super(...arguments);M(this,"Highlights",tt)}get highlightsTarget(){const n=document.querySelector("cg-container");if(!n)throw new Error("Highlights target not found");const o=bt();return n.appendChild(o),o}get movesContainer(){const n=document.querySelector("rm6");if(!n)throw new Error("Moves container not found");return n}get statusTarget(){const n=document.querySelector(".round__app.variant-standard");if(!n)throw new Error("Status target not found");return n}isGame(){var i;const n=document.querySelector(".message > div:nth-child(1)"),o=n&&((i=n.textContent)==null?void 0:i.includes("It's your turn!"))||!1;return!!document.querySelector("l4x")||o}scrapeMoves(){let n=[];for(const o of document.querySelectorAll("l4x kwdb"))o.textContent&&n.push(o.textContent);return n}}const jt="";function wt(e){let t,n;return{c(){t=F("div"),m(t,"class",n=me(e[0])+" svelte-15mzqdd"),m(t,"style",e[1])},m(o,i){b(o,t,i)},p(o,[i]){i&1&&n!==(n=me(o[0])+" svelte-15mzqdd")&&m(t,"class",n),i&2&&m(t,"style",o[1])},i:p,o:p,d(o){o&&_(t)}}}function $t(e,t,n){let o,i,{color:r}=t,{x:c,y:l}=t;return e.$$set=s=>{"color"in s&&n(2,r=s.color),"x"in s&&n(3,c=s.x),"y"in s&&n(4,l=s.y)},e.$$.update=()=>{e.$$.dirty&4&&n(1,o=`--highlight-color:${r};`),e.$$.dirty&24&&n(0,i=`highlight square-${c}${l}`)},[i,o,r,c,l]}class ne extends U{constructor(t){super(),J(this,t,$t,wt,A,{color:2,x:3,y:4})}}function He(e,t,n){const o=e.slice();return o[2]=t[n],o[4]=n,o}function Ae(e,t,n){const o=e.slice();return o[5]=t[n],o[4]=n,o}function je(e){let t,n,o,i;return t=new ne({props:{color:R(e[4]),x:e[5].from.x,y:e[5].from.y}}),o=new ne({props:{color:R(e[4]),x:e[5].to.x,y:e[5].to.y}}),{c(){x(t.$$.fragment),n=C(),x(o.$$.fragment)},m(r,c){w(t,r,c),b(r,n,c),w(o,r,c),i=!0},p(r,c){const l={};c&1&&(l.x=r[5].from.x),c&1&&(l.y=r[5].from.y),t.$set(l);const s={};c&1&&(s.x=r[5].to.x),c&1&&(s.y=r[5].to.y),o.$set(s)},i(r){i||(d(t.$$.fragment,r),d(o.$$.fragment,r),i=!0)},o(r){g(t.$$.fragment,r),g(o.$$.fragment,r),i=!1},d(r){$(t,r),r&&_(n),$(o,r)}}}function Be(e){let t,n;return t=new ne({props:{color:ee(e[4]),x:e[2].from.x,y:e[2].from.y}}),{c(){x(t.$$.fragment)},m(o,i){w(t,o,i),n=!0},p(o,i){const r={};i&2&&(r.x=o[2].from.x),i&2&&(r.y=o[2].from.y),t.$set(r)},i(o){n||(d(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){$(t,o)}}}function Ie(e){let t,n;return t=new ne({props:{color:ee(e[4]),x:e[2].to.x,y:e[2].to.y}}),{c(){x(t.$$.fragment)},m(o,i){w(t,o,i),n=!0},p(o,i){const r={};i&2&&(r.x=o[2].to.x),i&2&&(r.y=o[2].to.y),t.$set(r)},i(o){n||(d(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){$(t,o)}}}function Le(e){let t=k(e[2].from,e[0]),n,o=k(e[2].to,e[0]),i,r,c=t&&Be(e),l=o&&Ie(e);return{c(){c&&c.c(),n=C(),l&&l.c(),i=K()},m(s,a){c&&c.m(s,a),b(s,n,a),l&&l.m(s,a),b(s,i,a),r=!0},p(s,a){a&3&&(t=k(s[2].from,s[0])),t?c?(c.p(s,a),a&3&&d(c,1)):(c=Be(s),c.c(),d(c,1),c.m(n.parentNode,n)):c&&(O(),g(c,1,1,()=>{c=null}),S()),a&3&&(o=k(s[2].to,s[0])),o?l?(l.p(s,a),a&3&&d(l,1)):(l=Ie(s),l.c(),d(l,1),l.m(i.parentNode,i)):l&&(O(),g(l,1,1,()=>{l=null}),S())},i(s){r||(d(c),d(l),r=!0)},o(s){g(c),g(l),r=!1},d(s){c&&c.d(s),s&&_(n),l&&l.d(s),s&&_(i)}}}function Mt(e){let t,n,o,i=e[0],r=[];for(let f=0;f<i.length;f+=1)r[f]=je(Ae(e,i,f));const c=f=>g(r[f],1,1,()=>{r[f]=null});let l=e[1],s=[];for(let f=0;f<l.length;f+=1)s[f]=Le(He(e,l,f));const a=f=>g(s[f],1,1,()=>{s[f]=null});return{c(){for(let f=0;f<r.length;f+=1)r[f].c();t=C();for(let f=0;f<s.length;f+=1)s[f].c();n=K()},m(f,h){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(f,h);b(f,t,h);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(f,h);b(f,n,h),o=!0},p(f,[h]){if(h&1){i=f[0];let u;for(u=0;u<i.length;u+=1){const y=Ae(f,i,u);r[u]?(r[u].p(y,h),d(r[u],1)):(r[u]=je(y),r[u].c(),d(r[u],1),r[u].m(t.parentNode,t))}for(O(),u=i.length;u<r.length;u+=1)c(u);S()}if(h&3){l=f[1];let u;for(u=0;u<l.length;u+=1){const y=He(f,l,u);s[u]?(s[u].p(y,h),d(s[u],1)):(s[u]=Le(y),s[u].c(),d(s[u],1),s[u].m(n.parentNode,n))}for(O(),u=l.length;u<s.length;u+=1)a(u);S()}},i(f){if(!o){for(let h=0;h<i.length;h+=1)d(r[h]);for(let h=0;h<l.length;h+=1)d(s[h]);o=!0}},o(f){r=r.filter(Boolean);for(let h=0;h<r.length;h+=1)g(r[h]);s=s.filter(Boolean);for(let h=0;h<s.length;h+=1)g(s[h]);o=!1},d(f){V(r,f),f&&_(t),V(s,f),f&&_(n)}}}function Et(e,t,n){let o,i;return j(e,P,r=>n(0,o=r)),j(e,G,r=>n(1,i=r)),[o,i]}class Ct extends U{constructor(t){super(),J(this,t,Et,Mt,A,{})}}class Ot extends Ne{constructor(){super(...arguments);M(this,"Highlights",Ct)}get highlightsTarget(){const n=document.querySelector("chess-board");if(!n)throw new Error("Highlights target not found");return n}get movesContainer(){const n=document.querySelector("vertical-move-list");if(!n)throw new Error("Moves container not found");return n}get statusTarget(){const n=document.querySelector(".play-controller-message");if(!n)throw new Error("Status target not found");const o=document.createElement("div");return o.style.width="100000vh",o.style.height="25rem",n.insertBefore(o,n.firstChild),o}isGame(){return!!document.querySelector("vertical-move-list")}scrapeMoves(){let n=[];for(const o of document.querySelectorAll(".move .node"))o.textContent&&n.push(o.textContent);return n}}const fe=window.location.host==="lichess.org"?new vt:new Ot,St=setInterval(()=>{fe.isGame()&&(clearInterval(St),fe.mount())},1e3)})();
